using System.Threading;
using System.Threading.Tasks;
using PackagingTools.Core.Abstractions;
using PackagingTools.Core.Models;

namespace PackagingTools.Core.Security.Vulnerability;

/// <summary>
/// No-op vulnerability scanner used when no providers are configured.
/// </summary>
public sealed class NullVulnerabilityScanner : IVulnerabilityScanner
{
    public static NullVulnerabilityScanner Instance { get; } = new();

    public string Name => "none";

    public Task<VulnerabilityScanResult> ScanAsync(PackageFormatContext context, PackagingArtifact artifact, CancellationToken cancellationToken = default)
        => Task.FromResult(new VulnerabilityScanResult(Array.Empty<VulnerabilityFinding>(), null));
}
