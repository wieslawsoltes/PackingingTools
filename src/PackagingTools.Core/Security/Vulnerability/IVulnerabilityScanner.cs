using System.Threading;
using System.Threading.Tasks;
using PackagingTools.Core.Abstractions;
using PackagingTools.Core.Models;

namespace PackagingTools.Core.Security.Vulnerability;

/// <summary>
/// Scans packaging artifacts for vulnerabilities.
/// </summary>
public interface IVulnerabilityScanner
{
    string Name { get; }

    Task<VulnerabilityScanResult> ScanAsync(PackageFormatContext context, PackagingArtifact artifact, CancellationToken cancellationToken = default);
}

public sealed record VulnerabilityFinding(string Id, string Severity, string Description, string? AdvisoryUrl);

public sealed record VulnerabilityScanResult(VulnerabilityFinding[] Findings, PackagingIssue? Issue);
